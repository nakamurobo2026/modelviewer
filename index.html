<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<title>ナカムロボ AR</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

<style>
html, body {
  margin: 0;
  padding: 0;
  height: 100%;
  background: #000;
  overflow: hidden;
}

.container {
  display: flex;
  flex-direction: column;
  height: 100%;
}

model-viewer {
  width: 100%;
  height: 70%;
  background: #000;
  /* AR向け：遮断しすぎない */
  touch-action: manipulation;
}

.controls {
  height: 30%;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #111;
}

#ar-btn {
  width: 85%;
  height: 85px;
  background: #00ffcc;
  color: #000;
  font-size: 24px;
  font-weight: bold;
  border-radius: 45px;
  border: none;
}
</style>
</head>

<body>

<div class="container">
  <model-viewer
    id="mv"
    src="https://nakamurobo2026.github.io/modelviewer/dance.glb"
    ios-src="https://nakamurobo2026.github.io/modelviewer/dance.usdz"
    ar
    ar-modes="webxr quick-look"
    ar-placement="floor"
    ar-scale="auto"
    shadow-intensity="1"
    environment-image="neutral"
    interaction-prompt="none"
    autoplay>
  </model-viewer>

  <div class="controls">
    <button id="ar-btn">AR召喚</button>
  </div>
</div>

<script>
const mv = document.getElementById("mv");
const btn = document.getElementById("ar-btn");

btn.addEventListener("click", async () => {
  await mv.activateAR();
});

// AR開始時に「余計な操作」を切る
mv.addEventListener("ar-status", (e) => {
  if (e.detail.status === "session-started") {
    mv.removeAttribute("camera-controls");
    mv.removeAttribute("enable-pan");
  }
});
</script>

</body>
</html>
